# H4 Maailma kuulee 6.2.2024 klo 14-16.45.

## x) First Steps on a New Virtual Private Server – an Example on DigitalOcean and Ubuntu 16.04 LTS & Teoriasta käytäntöön pilvipalvelimen avulla (kohdat a,d,e ja f)

-	Luo DigitalOcean-tili ja käynnistä Ubuntu 16.04 LTS -palvelin.
-	Määritä palomuuri sallimaan SSH-yhteys - muista tehdä reikä!
-	Luo sudo-käyttäjä ja poista root-käyttäjän kirjautumismahdollisuus turvallisuuden vuoksi.
-	Päivitä ja päivitä ohjelmistopaketit turvallisuuden varmistamiseksi.
-	DNS-konfiguraatio NameCheapillä. 
-	Harkitse .me-verkkotunnuksen hankkimista GitHub Education Package -ohjelman kautta.
-	Ohjaa NameCheapin nimipalvelimet palvelimellesi.
-	Lisää A-tietue verkkotunnuksellesi.
-	Varmista DNS:n leviäminen "host" -komennolla ja testaa Firefoxilla välttääksesi välimuistiongelmia.
-	Aina kannattaa käyttää vahvoja salasanoja ja pitää ohjelmistot päivitettyinä turvallisuuden varmistamiseksi.

Lähteet: Karvinen 2012 & Lehto 2022

### Minun rauta

- MacOS Sonoma Versio 14.2.1
- MacBookPro 13-tuumainen, 2020
- Prosessori: 1,4 GHz Neliytiminen Intel Core i5
- Näytönohjain: Intel Iris Plus Graphics 645, 1536 Mt
- Muisti: 8 Gt 2133 MHz LPDDR3

## a) Vuokraa oma virtuaalipalvelin haluamaltasi palveluntarjoajalta. 7.1.2024 klo 8.30-10.05

Valitsin palveluntarjoajaksi DigitalOceanin (cloud.digitalocean.com). Tein sinne tunnukset, s-postia käyttäen.

<img width="364" alt="Näyttökuva 2024-2-7 kello 9 16 27" src="https://github.com/HannaBurman/koulutyot/assets/156779955/063a01c3-61ab-47e5-8332-e929844aef28">

Kun pääsin sisään, valitsin "Deploy a virtual machine".

<img width="621" alt="Näyttökuva 2024-2-7 kello 9 13 51" src="https://github.com/HannaBurman/koulutyot/assets/156779955/6a0dbeb7-0906-402f-a943-06a4ef0ceb7b">

Seuraavaksi valitsin "Create droplets" jossa valitsin lähinnä olevan datacenterin, eli Amsterdamin. 

<img width="1089" alt="Näyttökuva 2024-2-7 kello 9 40 52" src="https://github.com/HannaBurman/koulutyot/assets/156779955/c955a008-e1f5-4172-87c2-325172115dd6">

Imageksi valitsin Debianin. 

<img width="831" alt="Näyttökuva 2024-2-7 kello 9 43 04" src="https://github.com/HannaBurman/koulutyot/assets/156779955/56e0b290-f5cb-4add-8e62-d6d546cdc0dd">

Seuraavaksi piti valita "Droplet type", "CPU Options" ja niiden perusteella valita kuukausihinta.

<img width="991" alt="Näyttökuva 2024-2-7 kello 9 44 05" src="https://github.com/HannaBurman/koulutyot/assets/156779955/f4d32073-80f0-468d-b047-deb096e7a9e4">

Seuraavaksi piti valita tunnistautumistapa, johon valitsin vahvan root salasanan ja valitsin hostnameksi "habbe". 

<img width="926" alt="Näyttökuva 2024-2-7 kello 9 50 53" src="https://github.com/HannaBurman/koulutyot/assets/156779955/18c4f147-eeab-44cc-a246-9349471a8953">

Tämän jälkeen valitsin "Create droplet" minkä jälkeen sain DigitalOceanilta sähköpostin, jossa pyydettiin vahvistamaan osoite. 
Tämän jälkeen sain vielä toisen sähköpostin, jossa DigitalOcean antoi $200.00 kredittiä, joissa on 60 päivän käyttöaika. 

<img width="732" alt="Näyttökuva 2024-2-7 kello 15 12 35" src="https://github.com/HannaBurman/koulutyot/assets/156779955/1bb2fef0-ebfb-420f-99fd-2da5f5b353a2">

## b) Tee alkutoimet omalla virtuaalipalvelimellasi: tulimuuri päälle, root-tunnus kiinni, ohjelmien päivitys. 7.2.2024 klo 16.15-18.15

Valitsin ensimmäisenä tekemäni "habbe" dropletin. 

<img width="1292" alt="Näyttökuva 2024-2-6 kello 12 47 51" src="https://github.com/HannaBurman/koulutyot/assets/156779955/3da24318-bb87-4e2c-9dc4-86c9fd509161">

Habbe -dropletin sisältä valitsin vasemmalta puolelta taulukosta "access". Siellä olisi ollut mahdollista avata Droplet Console, mutta ilmeisesti sitä on hieman hidas ja hankala käyttää, joten avasin virtuaalikoneestani Debianin terminaalin. Ennen sitä otin sivustolta ipv4 osoitteen (159.223.12.224) talteen. 

<img width="1292" alt="Näyttökuva 2024-2-6 kello 12 50 26" src="https://github.com/HannaBurman/koulutyot/assets/156779955/08cc9c48-fbd6-483c-8752-913eac5ac99c">

Seraavaksi avasin Debianin terminaalin ja annoin komennon

    ssh root@159.223.12.224

jotta saisin pääsyn palvelimen juureen.

Tämän jälkeen terminaali kysyi haluanko varmasti jatkaa, sillä iipparia ei pystytä varmistamaan. Vastasin "yes". Tämän jälkeen annoin vielä root salasanan. 
    
<img width="640" alt="Näyttökuva 2024-2-6 kello 12 55 41" src="https://github.com/HannaBurman/koulutyot/assets/156779955/a78f411f-0bf1-44b9-b84c-c37ab04d437c">

Tämän jälkeen tein komennot rootina (root@habbe:~#). Seuraavaksi halusin päivittää pakettivarastot, joten annoin komennon

    sudo apt-get update

<img width="638" alt="Näyttökuva 2024-2-6 kello 13 08 15" src="https://github.com/HannaBurman/koulutyot/assets/156779955/b3aa7a29-be9d-40f7-9d4c-f20a1ebf7e99">

Seuraavaksi latasin palomuurin komennolla

    sudo apt-get install ufw
    
<img width="642" alt="Näyttökuva 2024-2-7 kello 17 26 58" src="https://github.com/HannaBurman/koulutyot/assets/156779955/a3201241-c618-49e9-b2db-a131a800816d">

Seuraavaksi tein palomuuriin reijän SSH-yhteyttä varten ja kytkin palomuurin päälle komennoilla

    sudo ufw allow 22/tcp
    sudo ufw enable

<img width="642" alt="Näyttökuva 2024-2-7 kello 17 27 54" src="https://github.com/HannaBurman/koulutyot/assets/156779955/600ac3bb-be05-460f-b857-b6dcf12a0edb">

Tarkistettu palomuurin tila vielä komennolla

    sudo ufw status

<img width="511" alt="Näyttökuva 2024-2-7 kello 17 32 10" src="https://github.com/HannaBurman/koulutyot/assets/156779955/796e2ce2-1d9d-4fa9-9b4e-405c8939171e">

Sitten loin käyttäjän ja seuraavaksi käyttäjästä pääkäyttäjän komennoilla

    sudo adduser
    sudo adduser habbe

<img width="640" alt="Näyttökuva 2024-2-7 kello 17 35 35" src="https://github.com/HannaBurman/koulutyot/assets/156779955/9592d773-6985-409e-9645-7c8cf3f8d9d5">

Testasin vielä toimivuuden echolla.

<img width="259" alt="Näyttökuva 2024-2-7 kello 17 36 50" src="https://github.com/HannaBurman/koulutyot/assets/156779955/963f815e-14bf-4521-820f-2151cfed79e2">

Olin unohtanut sallia portin 80 ja sen protokollan, joiden avulla Http-liikenne mahdollistuu. Tästä syystä tein vielä lopuksi sen (kiitos tehtävänannon lopussa olleille vihjeille!) komennolla

    sudo ufw allow 80/tcp

<img width="369" alt="Näyttökuva 2024-2-7 kello 18 05 46" src="https://github.com/HannaBurman/koulutyot/assets/156779955/d9f38b19-cb71-4462-a39e-cce7bbe1a5cd">


## c) Asenna weppipalvelin omalle virtuaalipalvelimellesi. Korvaa testisivu. Kokeile, että se näkyy julkisesti. Kokeile myös eri koneelta, esim kännykältä. 7.2.2024 klo 


## d) Vuokraa domain-nimi ja aseta se osoittamaan virtuaalipalvelimeesi. 7.2.2024 klo 20min

Vuokrasin  nimipalvelimen Namecheapilta osoitteessa www.namecheap.com. 

<img width="1286" alt="Näyttökuva 2024-2-7 kello 10 19 18" src="https://github.com/HannaBurman/koulutyot/assets/156779955/20a693d5-1fdf-47ad-bfcb-c669e4d9538d">

Valisin nimeksi Burman.store ja otin sen vuodeksi (ei uusiutuva). Nimi maksoi yhteensä $1.16.  



Vinkit:

Aina hyvät salasanat. Salasana on todella tärkeä kohta tietoturvassa.
Muista tehdä reikä tulimuuriin. sudo ufw allow 22/tcp; sudo ufw enable; sudo ufw allow 80/tcp
Käyttäjälle saa sudo-oikeudet lisäämällä ryhmään "sudo". Muita artikkelissa mainittuja ryhmiä "adm", "admin"... ei välttämättä ole koneellasi.
sudo apt-get update; sudo apt-get dist-upgrade; sudo systemctl reboot
Nykyisin demonin uudelleenkäynnistys 'sudo systemctl restart apache2' (ei enää service)
Perinteisesti lokit ovat olleet tekstitiedostoissa /var/log/ alla. Nyt ne ovat siirtymässä journalctl:n. Archwiki: systemd/Journal. Tunnilla jonkun palveluntarjoajan valmiskuvaa käyttäessä lokien löytämisessä oli kummallisuuksia.
Julkisia nimiä vuokraa mm NameCheap
Nimen säätäminen
"Advanced DNS"
A-tietue, @ (tarkoittaa sitä nimeä, jota ollaan käsittelemässä), virtuaalipalvelimen julkinen IP
Toinen A-tietue www:lle
Muut tietueet (esim palveluntarjoajan mainokset) kannattaa poistaa
Muutokset tulevat näkyviin 5 min - 4 tunnin kuluttua
Raportteja palvelimen vuokraamisesta ja nimen säätämisestä https://www.google.com/search?q=namecheap+karvinen , esimerkiksi
* Jos et jostain syystä halua vuokrata oikeaa nimeä, voit vaihtoehtotehtävänä kokeilla nimipalvelua tai sen simulointia hosts-tiedoston avulla. Tällöin voit tehdä nimipalvelutietojen analysoinnin mistä vain julkisessa käytössä olevasta nimestä.
Suosittelen kuitenkin oikean nimen vuokraamista ja asettamista. Github Education -paketin mukana saattaa tulla ilmaisia nimiä. Ilmaiset tai halvat nimet ovat usein edullisia vain ensimmäisen vuoden.
Tuotantoon yleensä .com nimi on sopivin.

## Lähteet

- Karvinen, T. 2012. First Steps on a New Virtual Private Server – an Example on DigitalOcean and Ubuntu 16.04 LTS. Luettavissa: https://terokarvinen.com/2017/first-steps-on-a-new-virtual-private-server-an-example-on-digitalocean/. Luettu 6.2.2024.
- Lehto, S. 2022. Teoriasta käytäntöön pilvipalvelimen avulla (h4) (opiskelijan esimerkkiraportti), kohdat a,d,e ja f. Luettavissa: https://susannalehto.fi/2022/teoriasta-kaytantoon-pilvipalvelimen-avulla-h4/. Luettu 6.2.2024. 
